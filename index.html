<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÿµÿØÿßÿ¶€í ŸÇÿ±ÿ¢ŸÜ | Sayyid Sakhar Hashmi</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Nastaliq+Urdu&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #d4af37; --bg: #010405; --sidebar-bg: #080b0c;
            --text-main: #ffffff; --text-dim: #94a3b8;
            --arabic-clr: #ffffff; --translation-clr: #94a3b8;
        }
        .light-mode {
            --bg: #ffffff; --sidebar-bg: #f1f5f9;
            --text-main: #0f172a; --text-dim: #475569;
            --accent: #2563eb; --arabic-clr: #1e3a8a; --translation-clr: #991b1b;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--bg); color: var(--text-main); font-family: 'Inter', sans-serif; height: 100vh; display: flex; overflow: hidden; }
        aside { width: 30%; background: var(--sidebar-bg); border-left: 1px solid rgba(212, 175, 55, 0.1); display: flex; flex-direction: column; z-index: 10; }
        .sidebar-header { padding: 20px 10px; text-align: center; border-bottom: 1px solid rgba(212, 175, 55, 0.1); }
        .sidebar-header h2 { font-family: 'Noto Nastaliq Urdu', serif; color: var(--accent); font-size: 1.6rem; margin-bottom: 5px; }
        .credits { font-family: 'Noto Nastaliq Urdu', serif; font-size: 0.65rem; color: var(--text-dim); }
        .trans-switcher { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 3px; padding: 5px; background: rgba(0,0,0,0.1); }
        .t-btn { background: rgba(128,128,128,0.1); border: 1px solid transparent; color: var(--text-dim); padding: 5px 1px; border-radius: 4px; font-size: 0.55rem; cursor: pointer; font-weight: 600; }
        .t-btn.active-t { border-color: var(--accent); color: var(--accent); background: rgba(212, 175, 55, 0.1); }
        .surah-list { flex: 1; overflow-y: auto; padding: 8px; }
        .surah-item { padding: 10px 12px; margin-bottom: 5px; background: rgba(128,128,128,0.03); border-radius: 6px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; white-space: nowrap; }
        .surah-item.active-surah { background: rgba(212, 175, 55, 0.08); border-right: 3px solid var(--accent); }
        .s-name { font-family: 'Amiri', serif; font-size: 1.1rem; font-weight: 700; }
        .s-num { font-size: 0.55rem; opacity: 0.4; }
        main { width: 70%; display: flex; flex-direction: column; }
        .display-container { flex: 1; overflow-y: auto; padding: 40px 10%; scroll-behavior: smooth; }
        .ayah-block { padding: 70px 0; text-align: center; opacity: 0.1; transition: 0.5s ease; }
        .ayah-block.active { opacity: 1; transform: scale(1.02); }
        .arabic-text { font-family: 'Amiri', serif; font-size: 1.9rem; line-height: 2; margin-bottom: 20px; color: var(--arabic-clr); }
        .urdu-text { font-family: 'Noto Nastaliq Urdu', serif; font-size: 1.1rem; color: var(--translation-clr); line-height: 2.5; }
        footer { min-height: 80px; background: rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px; border-top: 1px solid rgba(128,128,128,0.1); padding: 10px; }
        .controls-row { display: flex; align-items: center; gap: 12px; }
        .btn { background: var(--accent); color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.65rem; font-weight: 600; }
        .nav-btn { background: rgba(128,128,128,0.2); color: var(--text-main); padding: 5px 10px; border-radius: 4px; border: none; cursor: pointer; font-size: 0.8rem; }
        .goto-box { display: flex; gap: 5px; align-items: center; }
        .goto-box input { width: 40px; background: rgba(255,255,255,0.1); border: 1px solid var(--text-dim); color: var(--text-main); border-radius: 3px; padding: 2px 5px; font-size: 0.7rem; text-align: center; }
        .mode-toggle { cursor: pointer; font-size: 1.2rem; margin-left: 15px; }
        .surah-list::-webkit-scrollbar { width: 3px; }
        .surah-list::-webkit-scrollbar-thumb { background: var(--accent); }
    </style>
</head>
<body>
    <aside>
        <div class="sidebar-header">
            <h2>ÿµÿØÿßÿ¶€í ŸÇÿ±ÿ¢ŸÜ</h2>
            <div class="credits">Ÿæ€åÿ¥⁄©ÿ¥: ÿ≥€åÿØ ÿ≥ÿßÿÆÿ± €Åÿßÿ¥ŸÖ€å</div>
        </div>
        <div class="trans-switcher">
            <button class="t-btn active-t" id="btn-ur-najafi" onclick="changeTrans('ur.najafi')">NAJAFI</button>
            <button class="t-btn" id="btn-ur-jalandhry" onclick="changeTrans('ur.jalandhry')">JALANDHRY</button>
            <button class="t-btn" id="btn-ur-qadri" onclick="changeTrans('ur.qadri')">QADRI</button>
        </div>
        <div class="surah-list" id="surahList"></div>
    </aside>
    <main>
        <div class="display-container" id="displayArea"></div>
        <footer>
            <div class="controls-row">
                <button class="nav-btn" onclick="prevAyah()">‚ùÆ</button>
                <button class="btn" onclick="togglePlay()" id="playPauseBtn" style="width: 70px;">Pause</button>
                <button class="nav-btn" onclick="nextAyah()">‚ùØ</button>
                <div class="goto-box">
                    <input type="number" id="ayahNumInput" placeholder="ÿ¢€åÿ™">
                    <button class="btn" onclick="goToAyah()" style="padding: 4px 8px;">GO</button>
                </div>
                <span class="mode-toggle" onclick="toggleMode()">üåì</span>
            </div>
            <span id="status" style="font-size: 0.6rem; color: var(--accent); letter-spacing: 1px; font-weight: bold;">READY</span>
        </footer>
    </main>
    <audio id="audioEngine"></audio>

    <script>
        const surahListEl = document.getElementById('surahList');
        const displayArea = document.getElementById('displayArea');
        const audioEngine = document.getElementById('audioEngine');
        const statusEl = document.getElementById('status');
        const playPauseBtn = document.getElementById('playPauseBtn');

        let ayatsData = [];
        let activeIndex = 0;
        let currentTrans = 'ur.najafi';
        let currentSurahNum = null;
        let currentSurahName = "";

        fetchSurahs();

        async function fetchSurahs() {
            const res = await fetch('https://api.alquran.cloud/v1/surah');
            const data = await res.json();
            data.data.forEach(s => {
                const item = document.createElement('div');
                item.className = 'surah-item';
                item.id = `surah-${s.number}`;
                item.innerHTML = `<span class="s-name">${s.name}</span><span class="s-num">${s.number}</span>`;
                item.onclick = () => loadSurah(s.number, s.name);
                surahListEl.appendChild(item);
            });
        }

        async function loadSurah(num, name) {
            currentSurahNum = num;
            currentSurahName = name;
            document.querySelectorAll('.surah-item').forEach(i => i.classList.remove('active-surah'));
            document.getElementById(`surah-${num}`).classList.add('active-surah');
            
            statusEl.innerText = "LOADING...";
            const res = await fetch(`https://api.alquran.cloud/v1/surah/${num}/editions/quran-uthmani,${currentTrans},ar.alafasy`);
            const data = await res.json();
            
            ayatsData = data.data[0].ayahs.map((a, i) => ({
                ar: a.text, ur: data.data[1].ayahs[i].text, audio: data.data[2].ayahs[i].audio
            }));

            renderUI();
            activeIndex = 0;
            playCurrent();
            updateMediaSession();
        }

        async function changeTrans(slug) {
            currentTrans = slug;
            document.querySelectorAll('.t-btn').forEach(b => b.classList.remove('active-t'));
            document.getElementById('btn-' + slug.replace('.', '-')).classList.add('active-t');
            if(currentSurahNum) {
                const res = await fetch(`https://api.alquran.cloud/v1/surah/${currentSurahNum}/${currentTrans}`);
                const data = await res.json();
                data.data.ayahs.forEach((ayah, i) => { ayatsData[i].ur = ayah.text; });
                renderUI();
                highlightAyah();
            }
        }

        function renderUI() {
            displayArea.innerHTML = ayatsData.map((d, i) => `
                <div class="ayah-block" id="ayah-${i}">
                    <div class="arabic-text">${d.ar}</div>
                    <div class="urdu-text">${d.ur}</div>
                </div>
            `).join('');
        }

        function playCurrent() {
            if (activeIndex < 0 || activeIndex >= ayatsData.length) return;
            highlightAyah();
            
            // ÿ®€å⁄© ⁄Øÿ±ÿßÿ§ŸÜ⁄à ŸæŸÑ€í ⁄©€í ŸÑ€å€í ÿß€ÅŸÖ ÿ™ÿ±€åŸÜ ÿ≠ÿµ€Å
            audioEngine.pause();
            audioEngine.src = ayatsData[activeIndex].audio;
            audioEngine.load(); // ŸÅÿßÿ¶ŸÑ ⁄©Ÿà ÿ±€å-ŸÑŸà⁄à ⁄©ÿ±€å⁄∫
            
            const playPromise = audioEngine.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    statusEl.innerText = `RECITING: ${currentSurahName} (AYAH ${activeIndex + 1})`;
                }).catch(error => {
                    console.log("Autoplay blocked, waiting for user interaction");
                });
            }
        }

        // ÿß€åŸàŸÜŸπ ŸÑÿ≥ŸÜÿ± ÿ¨Ÿà ÿß⁄ØŸÑ€å ÿ¢€åÿ™ ÿÆŸàÿØ ÿ®ÿÆŸàÿØ ⁄ÜŸÑÿßÿ¶€í ⁄Øÿß
        audioEngine.addEventListener('ended', () => {
            activeIndex++;
            if (activeIndex < ayatsData.length) {
                playCurrent();
            } else {
                statusEl.innerText = "COMPLETED";
            }
        });

        function highlightAyah() {
            document.querySelectorAll('.ayah-block').forEach(b => b.classList.remove('active'));
            const current = document.getElementById(`ayah-${activeIndex}`);
            if (current) {
                current.classList.add('active');
                current.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function togglePlay() {
            if (audioEngine.paused) { audioEngine.play(); playPauseBtn.innerText = "Pause"; }
            else { audioEngine.pause(); playPauseBtn.innerText = "Play"; }
        }

        function nextAyah() { if (activeIndex < ayatsData.length - 1) { activeIndex++; playCurrent(); } }
        function prevAyah() { if (activeIndex > 0) { activeIndex--; playCurrent(); } }
        function goToAyah() {
            const num = parseInt(document.getElementById('ayahNumInput').value);
            if (num > 0 && num <= ayatsData.length) { activeIndex = num - 1; playCurrent(); }
        }
        function toggleMode() { document.body.classList.toggle('light-mode'); }

        function updateMediaSession() {
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: currentSurahName, artist: 'ÿµÿØÿßÿ¶€í ŸÇÿ±ÿ¢ŸÜ', album: 'ÿ≥€åÿØ ÿ≥ÿßÿÆÿ± €Åÿßÿ¥ŸÖ€å',
                });
                navigator.mediaSession.setActionHandler('play', () => togglePlay());
                navigator.mediaSession.setActionHandler('pause', () => togglePlay());
                navigator.mediaSession.setActionHandler('nexttrack', () => nextAyah());
                navigator.mediaSession.setActionHandler('previoustrack', () => prevAyah());
            }
        }
    </script>
</body>
</html>
